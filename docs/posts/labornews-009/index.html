<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="박영삼">
<meta name="dcterms.date" content="2023-07-21">

<title>청년 고용률 하락과 ‘쉬었음’ 증가, 심상치 않다 – Labor &amp; Society</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Labor &amp; Society</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://facebook.com"> <i class="bi bi-facebook" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://yspark1968.blogspot.com/"> 
<span class="menu-text">Blogger</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">청년 고용률 하락과 ‘쉬었음’ 증가, 심상치 않다</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">청년 고용률</div>
                <div class="quarto-category">쉬었음</div>
                <div class="quarto-category">노동시장</div>
                <div class="quarto-category">비경제활동인구</div>
                <div class="quarto-category">청년</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>박영삼 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 21, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#청년-고용률-하락과-쉬었음-증가-심상치-않다" id="toc-청년-고용률-하락과-쉬었음-증가-심상치-않다" class="nav-link active" data-scroll-target="#청년-고용률-하락과-쉬었음-증가-심상치-않다">청년 고용률 하락과 ‘쉬었음’ 증가, 심상치 않다</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="박영삼의-통계로-보는-노동" class="level4">
<h4 class="anchored" data-anchor-id="박영삼의-통계로-보는-노동">박영삼의 통계로 보는 노동</h4>
</section>
<section id="청년-고용률-하락과-쉬었음-증가-심상치-않다" class="level2">
<h2 class="anchored" data-anchor-id="청년-고용률-하락과-쉬었음-증가-심상치-않다">청년 고용률 하락과 ‘쉬었음’ 증가, 심상치 않다</h2>
<section id="월-고용동향-1529세-취업자-감소-인구-감소보다-고용률-하락-때문" class="level4">
<h4 class="anchored" data-anchor-id="월-고용동향-1529세-취업자-감소-인구-감소보다-고용률-하락-때문">6월 고용동향 15~29세 취업자 감소 … 인구 감소보다 고용률 하락 때문</h4>
<p>지난주 통계청의 6월 고용동향이 발표됐다. 2023년 상반기까지의 고용상황이 집계된 것이고, 윤석열 정부 출범 이후 만 1년의 고용성적표가 공개된 것이다.</p>
<p>정부는 고용률이 역대 최고(63.5%)이며 취업자(+33만3천명)도 28개월 연속 증가세를 유지했다고 자평했다. 언론은 늘어난 취업자는 대부분 60대 이상 고령자(+34만3천명)이며 청년들의 경우 8개월째 취업자 감소가 이어지면서 6월에도 11만7천명 감소했다고 혹평했다. 정부는 이에 대해 지난해 청년 취업자가 많이 증가했던 기저효과(2022년 6월 +10만4천명)의 영향이 크고 청년의 인구감소(-17만2천명)를 고려해야 한다고 설명하고 있다.</p>
<section id="급격한-인구구조-변화-연령별-고용지표에-의문부호" class="level5">
<h5 class="anchored" data-anchor-id="급격한-인구구조-변화-연령별-고용지표에-의문부호">급격한 인구구조 변화, 연령별 고용지표에 의문부호</h5>
<p>고령자 중심의 취업자 증가 현상과 청년 취업자 감소 현상을 어떻게 봐야 할까. 고용동향이 발표될 때마다 60대 이상 고령자 중심의 취업자 증가라는 평가는 달라지지 않고 있다. 현 정부도 청년고용에 대해서 만큼은 전 정부의 설명을 따라서 인구감소 때문이라고 말하는데, 그것은 어느 정도 사실에 부합하는 것일까?</p>
<p>우선 우리나라의 연령별 인구구조는 굴곡이 매우 심하다. 10년 단위로 만 나이 연령대를 구분해서 취업자 증가 규모를 전년 동기와 비교하게 되면, 각 연령대의 취업자 규모 차이는 바로 앞 연령대의 ~9세 연령 취업자 규모의 영향을 그대로 받는다. 특히 60대와 20대의 경우에는 59세와 14세의 인구 숫자에 워낙 큰 차이가 있어서 더 큰 영향을 받는다. 매년 60대로 합류하게 되는 50대 후반 연령대의 평균 인구는 90만명 규모인 반면, 10대 초·중반 인구는 40만명 규모에 불과하기 때문이다.</p>
<p>그렇다면 출생년도를 기준으로 10년 단위 그룹을 나누면 어떻게 될까. 만 나이 변화에 따른 9세 효과는 사라지게 된다. 대신 사망인구가 점점 늘어나게 되는 1940년 이전 출생세대는 인구와 취업자가 계속 감소하게 되고, 매년 신규 인구가 유입되는 2000년 이후 출생그룹은 인구와 취업자가 계속 증가하게 된다.</p>
</section>
<section id="청년-취업자-감소-인구-요인-vs-고용률-요인" class="level5">
<h5 class="anchored" data-anchor-id="청년-취업자-감소-인구-요인-vs-고용률-요인">청년 취업자 감소 ‘인구 요인 vs 고용률 요인’</h5>
<p>통계청처럼 만 나이 기준 10년 구간을 설정하게 되면 증가한 취업자 대부분이 60대 이상으로 나온다. 2021년 이후 3년간 취업자 증가분의 68.6%, 56.1%, 103.0%를 60대 이상이 차지한다. 한편 출생연대별로 집단을 구분하면 앞서와 반대로 젊은층에 해당하는 1990년대생들이 2021년 이후 취업자 증가의 87.8%, 53.5%, 87.4%를 각각 점유한 것으로 나타난다. 전자의 방식은 연령대별 인구 분모의 변화를 제대로 반영하지 못하고 있고, 후자의 방식은 청년층과 노령층의 신규 진입과 퇴출을 고려하지 않은 맹점이 있다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="216333_93557_4820.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>현재로서는 취업자 증가 요인을 인구증가에 의한 효과와 해당 인구의 고용률 증가에 따른 효과로 분해하는 방법이 있다. 인구효과는 고용률이 전년과 같다는 가정하에 인구변화에 따른 취업자수 증감 효과를 나타내고, 고용률 효과는 인구가 전년과 같다는 가정하에 고용률 변화에 따른 취업자수 변화를 나타낸다. 전체 취업자 증가는 인구효과와 고용률 효과의 합계로 나타난다. 인구효과를 주어진 변수로 간주한다면 고용률 효과에는 경기변동 영향과 정부정책 효과도 포함된다.</p>
</section>
<section id="고용률-효과-마이너스-1529세가-유일" class="level5">
<h5 class="anchored" data-anchor-id="고용률-효과-마이너스-1529세가-유일">고용률 효과 마이너스, 15~29세가 유일</h5>
<p>이 방법으로 6월 고용동향의 취업자 증감치를 요인분해하면 아래 표와 같다. 15~29세 청년층의 경우 –11만7천명의 취업자 감소 규모 중 –8만1천명은 지난해 고용률 수준에서 인구가 감소한 영향이다. –3만6천명의 추가적인 취업자 감소는 고용률이 –0.4%포인트 감소한 것에 따른 영향이다. 30대의 경우 인구감소 영향은 –5만7천명 정도 있었으나 고용률이 지난해보다 높아져 7만명의 취업자 증가를 나타낼 수 있었다. 40대는 인구감소 영향이 –9만3천명 있었으나 고용률 증가로 취업자 감소폭을 –3만4천명 정도로 줄일 수 있었다. 50대는 인구감소 영향이 미미하게 있었으나 고용률 증가 영향이 더 커서 취업자가 7만1천명증가했다. 한편 60대이상의 경우 인구증가 영향도 23만6천명 있었지만 고용률 상승 영향이 더 보태져 취업자는 34만3천명이나 증가했다. 이를 종합해 보면 60대 이상의 취업자 증가는 인구효과뿐만 아니라 고용률 효과가 더해진 것이며, 20대 이하 청년층의 고용감소는 인구감소 때문만이 아니라 고용률도 감소한 영향이 중첩된 것이다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="216333_93544_3451.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>지금의 상황은 윤석열 정부 출범 이전과는 양상이 다르다. 코로나 위기 발발 이전에 20대 이하 청년들은 인구감소에도 6만명 이상의 취업자 증가를 보이고 있었다. 고용률이 증가하고 있었기 때문이다. 코로나 사태로 고용률이 급락한 때가 있었지만 2021년 4월부터는 다시 증가하기 시작했고 2022년 10월까지 무려 20개월 연속 증가세를 보였다. 이 시기에 청년층의 취업자 증가는 인구감소 영향을 넘어서는 고용률 증가로 가능했다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="216333_93545_3451.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>계절조정 청년 고용률도 2021년 6월(44.6%)에 코로나 위기 이전 수준(2020년 1월, 44.4%)을 회복했고 2022년 5월에는 1999년 이후 계절조정치 기준 역대 최고치인 47.2%를 기록하게 된다. 이러던 청년고용이 마이너스 증가로 떨어진 것은 2022년 11월이었다. 그리고 지난달까지 8개월째 청년취업자 감소는 이어지고 있다. 감소 규모도 5만명 미만에서 이제는 10만명을 훨씬 넘고 있다. 인구감소 영향이 아니라 고용률 하락 때문이다.</p>
</section>
<section id="한국에는-왜-장기실업장기구직이-없나" class="level5">
<h5 class="anchored" data-anchor-id="한국에는-왜-장기실업장기구직이-없나">한국에는 왜 ’장기실업=장기구직’이 없나</h5>
<p>앞으로의 상황도 희망적이지 않다. 청년층의 공식실업률은 역대 최저(6.3%)이고 비경제활동인구 가운데 구직활동에 나설 가능성이 있는 최대치인 ’고용보조지표3’조차 17%로 역대 가장 낮은 수준이다. 청년들 가운데 지난주 구직활동을 하지 않고 ’쉬었음’이라고 답한 인구는 38만6천명으로 코로나 이전보다 많아졌다. 그 안에서 취업을 희망하는 잠재구직자는 7만8천명으로 줄었고 노동시장 사정이 나아지면 구직활동을 해 볼 수 있다고 생각하는 구직단념자(실망실업자)는 3만2천명에 불과했다. 이들 중에는 과거 직장에서 일한 적이 있는 사람이 절반 이상 포함돼 있는데도 그렇다. 직장의 규모는 대부분 30명 미만 사업장에 속했던 사람들이다.</p>
<p>한국에 장기 구직활동이 없는 것은 장기 실업급여가 없다는 말과 동의어다. 청년들은 실업급여를 받기도 어렵지만 받아도 5개월을 넘기 어렵다. 청년들이 왜 구직활동을 하지 않고 쉬고 있는지, 청년을 가장 많이 생각한다는 정부가 생각해 봐야 할 일이다.</p>
<p>고려대 노동문제연구소 노동데이터센터장 (<a href="youngsampk@gmail.com">youngsampk@gmail.com</a>)<br>
</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>